"use strict";(self.webpackChunkFreshCart=self.webpackChunkFreshCart||[]).push([[515],{1515:(y,p,i)=>{i.r(p),i.d(p,{PaymentComponent:()=>F});var _=i(6814),e=i(95),t=i(4769),C=i(1120),m=i(6286);function P(n,s){1&n&&(t.TgZ(0,"p",16),t._uU(1,"Details is required"),t.qZA())}function a(n,s){1&n&&(t.TgZ(0,"p",16),t._uU(1,"Minimum length is 3 characters"),t.qZA())}function d(n,s){1&n&&(t.TgZ(0,"p",16),t._uU(1,"Maximum length is 20 characters"),t.qZA())}function x(n,s){if(1&n&&(t.TgZ(0,"div",14),t.YNc(1,P,2,0,"p",15),t.YNc(2,a,2,0,"p",15),t.YNc(3,d,2,0,"p",15),t.qZA()),2&n){const o=t.oxw();let l,r,u;t.xp6(1),t.Q6J("ngIf",null==(l=o.orderForm.get("details"))?null:l.hasError("required")),t.xp6(1),t.Q6J("ngIf",null==(r=o.orderForm.get("details"))?null:r.hasError("minlength")),t.xp6(1),t.Q6J("ngIf",null==(u=o.orderForm.get("details"))?null:u.hasError("maxlength"))}}function w(n,s){1&n&&(t.TgZ(0,"p",16),t._uU(1,"Phone is required"),t.qZA())}function b(n,s){1&n&&(t.TgZ(0,"p",16),t._uU(1,"Phone number format is invalid"),t.qZA())}function T(n,s){if(1&n&&(t.TgZ(0,"div",14),t.YNc(1,w,2,0,"p",15),t.YNc(2,b,2,0,"p",15),t.qZA()),2&n){const o=t.oxw();let l,r;t.xp6(1),t.Q6J("ngIf",null==(l=o.orderForm.get("phone"))?null:l.hasError("required")),t.xp6(1),t.Q6J("ngIf",null==(r=o.orderForm.get("phone"))?null:r.hasError("pattern"))}}function E(n,s){1&n&&(t.TgZ(0,"p",16),t._uU(1,"City is required"),t.qZA())}function Z(n,s){if(1&n&&(t.TgZ(0,"div",14),t.YNc(1,E,2,0,"p",15),t.qZA()),2&n){const o=t.oxw();let l;t.xp6(1),t.Q6J("ngIf",null==(l=o.orderForm.get("city"))?null:l.hasError("required"))}}const I=function(n){return{"is-invalid":n}};let F=(()=>{class n{constructor(o,l){this._ActivatedRoute=o,this._CartService=l,this.cartId="",this.orderForm=new e.cw({details:new e.NI("",[e.kI.required,e.kI.minLength(3),e.kI.maxLength(20)]),phone:new e.NI("",[e.kI.required,e.kI.pattern(/^01[0125][0-9]{8}$/)]),city:new e.NI("",[e.kI.required])}),this.registerForm=new e.cw({name:new e.NI("",[e.kI.required,e.kI.minLength(3),e.kI.maxLength(20)]),email:new e.NI("",[e.kI.required,e.kI.email]),password:new e.NI("",[e.kI.required,e.kI.pattern(/^[a-zA-Z0-9_@]{6,}$/)]),rePassword:new e.NI("",[e.kI.required]),phone:new e.NI("",[e.kI.required,e.kI.pattern(/^01[0125][0-9]{8}$/)])},{validators:this.confirmPasswordValidator()})}confirmPasswordValidator(){return o=>{const l=o.get("password"),r=o.get("rePassword");return r?""===r.value?(r.setErrors({required:!0}),{required:!0}):l&&l.value!==r.value?(r.setErrors({mismatch:!0}),{mismatch:!0}):(r.setErrors(null),null):null}}handleForm(){console.log(this.orderForm.value),this._CartService.CheckOut(this.cartId,this.orderForm.value).subscribe({next:o=>{"success"===o.status&&(window.location.href=o.session.url)}})}ngOnInit(){this._ActivatedRoute.paramMap.subscribe({next:o=>{this.cartId=o.get("id")}})}static#t=this.\u0275fac=function(l){return new(l||n)(t.Y36(C.gz),t.Y36(m.N))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-payment"]],standalone:!0,features:[t.jDz],decls:21,vars:14,consts:[[1,"w-75","mx-auto","container","my-5","py-5","rounded","bg-main-light","px-5","py-5"],[3,"formGroup","ngSubmit"],["for","details",1,"fw-bold","pb-2"],["type","text","id","details","formControlName","details",1,"form-control","mb-3",3,"ngClass"],["class","alert alert-danger p-1 small w-50 mx-auto",4,"ngIf"],["for","phone",1,"fw-bold","pb-2"],["type","tel","id","phone","formControlName","phone",1,"form-control","mb-3",3,"ngClass"],["for","city",1,"fw-bold","pb-2"],["type","text","id","city","formControlName","city",1,"form-control","mb-3",3,"ngClass"],[1,"d-flex","justify-content-center","align-items-center",2,"min-height","20vh"],[1,"btn","btn-outline-info","w-75","w-md-25","d-flex","justify-content-center","align-items-center","flex-wrap","py-2","px-3",2,"border-width","1.5px","border-radius","6px","transition","background-color 0.3s ease, color 0.3s ease",3,"disabled"],[1,"d-flex","align-items-center"],[1,"fw-bold","fs-5","me-1","text-dark"],["src","./assets/images/visa-1.svg","alt","visa",2,"width","2rem"],[1,"alert","alert-danger","p-1","small","w-50","mx-auto"],["class","mb-0 text-center fs-6",4,"ngIf"],[1,"mb-0","text-center","fs-6"]],template:function(l,r){if(1&l&&(t.TgZ(0,"section")(1,"div",0)(2,"form",1),t.NdJ("ngSubmit",function(){return r.handleForm()}),t.TgZ(3,"label",2),t._uU(4,"Details:"),t.qZA(),t._UZ(5,"input",3),t.YNc(6,x,4,3,"div",4),t.TgZ(7,"label",5),t._uU(8,"Phone:"),t.qZA(),t._UZ(9,"input",6),t.YNc(10,T,3,2,"div",4),t.TgZ(11,"label",7),t._uU(12,"City:"),t.qZA(),t._UZ(13,"input",8),t.YNc(14,Z,2,1,"div",4),t.TgZ(15,"div",9)(16,"button",10)(17,"div",11)(18,"span",12),t._uU(19,"Pay Now"),t.qZA(),t._UZ(20,"img",13),t.qZA()()()()()()),2&l){let u,c,h,g,f,v;t.xp6(2),t.Q6J("formGroup",r.orderForm),t.xp6(3),t.Q6J("ngClass",t.VKq(8,I,(null==(u=r.orderForm.get("details"))?null:u.touched)&&(null==(u=r.orderForm.get("details"))?null:u.invalid))),t.xp6(1),t.Q6J("ngIf",(null==(c=r.orderForm.get("details"))?null:c.errors)&&(null==(c=r.orderForm.get("details"))?null:c.touched)),t.xp6(3),t.Q6J("ngClass",t.VKq(10,I,(null==(h=r.orderForm.get("phone"))?null:h.touched)&&(null==(h=r.orderForm.get("phone"))?null:h.invalid))),t.xp6(1),t.Q6J("ngIf",(null==(g=r.orderForm.get("phone"))?null:g.errors)&&(null==(g=r.orderForm.get("phone"))?null:g.touched)),t.xp6(3),t.Q6J("ngClass",t.VKq(12,I,(null==(f=r.orderForm.get("city"))?null:f.touched)&&(null==(f=r.orderForm.get("city"))?null:f.invalid))),t.xp6(1),t.Q6J("ngIf",(null==(v=r.orderForm.get("city"))?null:v.errors)&&(null==(v=r.orderForm.get("city"))?null:v.touched)),t.xp6(2),t.Q6J("disabled",!r.orderForm.valid)}},dependencies:[_.ez,_.mk,_.O5,e.UX,e._Y,e.Fj,e.JJ,e.JL,e.sg,e.u]})}return n})()},6286:(y,p,i)=>{i.d(p,{N:()=>C});var _=i(5619),e=i(4769),t=i(9862);let C=(()=>{class m{constructor(a){this._HttpClient=a,this.baseUrl="https://ecommerce.routemisr.com/api/v1/",this.cartNumber=new _.X(0)}AddToCart(a){return this._HttpClient.post(this.baseUrl+"cart",{productId:a})}getCartUser(){return this._HttpClient.get(this.baseUrl+"cart")}UpdataCartProductQuantity(a,d){return this._HttpClient.put(this.baseUrl+`cart/${a}`,{count:d})}removeItem(a){return this._HttpClient.delete(this.baseUrl+`cart/${a}`)}ClearCart(){return this._HttpClient.delete(this.baseUrl+"cart")}CheckOut(a,d){return this._HttpClient.post(this.baseUrl+`orders/checkout-session/${a}?url=http://localhost:4200`,{shippingAddress:d})}static#t=this.\u0275fac=function(d){return new(d||m)(e.LFG(t.eN))};static#e=this.\u0275prov=e.Yz7({token:m,factory:m.\u0275fac,providedIn:"root"})}return m})()}}]);